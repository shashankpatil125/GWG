import { hideOthers } from '../../../aria-hidden/dist/es2015/index.js';
import o from '../../../react-remove-scroll/dist/es2015/Combination.js';
import { useId } from '../../react-id/dist/index.module.js';
import { Primitive } from '../../react-primitive/dist/index.module.js';
import { Presence } from '../../react-presence/dist/index.module.js';
import { useFocusGuards } from '../../react-focus-guards/dist/index.module.js';
import { Portal } from '../../react-portal/dist/index.module.js';
import { FocusScope } from '../../react-focus-scope/dist/index.module.js';
import { DismissableLayer } from '../../react-dismissable-layer/dist/index.module.js';
import { Root as Root$1, Anchor, Content as Content$1, Arrow as Arrow$1 } from '../../react-popper/dist/index.module.js';
import { useControllableState } from '../../react-use-controllable-state/dist/index.module.js';
import { createContext } from '../../react-context/dist/index.module.js';
import { useComposedRefs } from '../../react-compose-refs/dist/index.module.js';
import { composeEventHandlers } from '../../primitive/dist/index.module.js';
import * as React from 'react';
import _extends from '../../../@babel/runtime/helpers/esm/extends.js';

const[C,g]=createContext("Popover");const Popover=e=>{const{children:o,open:t,defaultOpen:n,onOpenChange:a,modal:c=!1}=e,s=React.useRef(null),[u,p]=React.useState(!1),[d=!1,f]=useControllableState({prop:t,defaultProp:n,onChange:a});return React.createElement(Root$1,null,/*#__PURE__*/React.createElement(C,{contentId:useId(),triggerRef:s,open:d,onOpenChange:f,onOpenToggle:React.useCallback((()=>f((e=>!e))),[f]),hasCustomAnchor:u,onCustomAnchorAdd:React.useCallback((()=>p(!0)),[]),onCustomAnchorRemove:React.useCallback((()=>p(!1)),[]),modal:c},o))};const PopoverTrigger=/*#__PURE__*/React.forwardRef(((e,o)=>{const r=g("PopoverTrigger"),n=useComposedRefs(o,r.triggerRef),a=/*#__PURE__*/React.createElement(Primitive.button,_extends({type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":E(r.open)},e,{ref:n,onClick:composeEventHandlers(e.onClick,r.onOpenToggle)}));return r.hasCustomAnchor?a:/*#__PURE__*/React.createElement(Anchor,{asChild:!0},a)}));const PopoverContent=/*#__PURE__*/React.forwardRef(((e,o)=>{const{forceMount:r,...t}=e,a=g("PopoverContent");return React.createElement(Presence,{present:r||a.open},a.modal?/*#__PURE__*/React.createElement(P,_extends({},t,{ref:o})):/*#__PURE__*/React.createElement(x,_extends({},t,{ref:o})))}));const P=/*#__PURE__*/React.forwardRef(((r,t)=>{const{portalled:n=!0,...a}=r,s=g("PopoverContent"),u=React.useRef(null),i=useComposedRefs(t,u),l=React.useRef(!1);React.useEffect((()=>{const o=u.current;if(o)return hideOthers(o)}),[]);const p=n?Portal:React.Fragment;return React.createElement(p,null,/*#__PURE__*/React.createElement(o,null,/*#__PURE__*/React.createElement(h,_extends({},a,{ref:i,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:composeEventHandlers(r.onCloseAutoFocus,(e=>{var o;e.preventDefault(),l.current||null===(o=s.triggerRef.current)||void 0===o||o.focus();})),onPointerDownOutside:composeEventHandlers(r.onPointerDownOutside,(e=>{const o=e.detail.originalEvent,r=0===o.button&&!0===o.ctrlKey,t=2===o.button||r;l.current=t;}),{checkForDefaultPrevented:!1}),onFocusOutside:composeEventHandlers(r.onFocusOutside,(e=>e.preventDefault()),{checkForDefaultPrevented:!1})}))))})),x=/*#__PURE__*/React.forwardRef(((e,o)=>{const{portalled:r=!0,...t}=e,n=g("PopoverContent"),a=React.useRef(!1),s=r?Portal:React.Fragment;return React.createElement(s,null,/*#__PURE__*/React.createElement(h,_extends({},t,{ref:o,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var r,t;(null===(r=e.onCloseAutoFocus)||void 0===r||r.call(e,o),o.defaultPrevented)||(a.current||null===(t=n.triggerRef.current)||void 0===t||t.focus(),o.preventDefault());a.current=!1;},onInteractOutside:o=>{var r,t;null===(r=e.onInteractOutside)||void 0===r||r.call(e,o),o.defaultPrevented||(a.current=!0);const c=o.target;(null===(t=n.triggerRef.current)||void 0===t?void 0:t.contains(c))&&o.preventDefault();}})))})),h=/*#__PURE__*/React.forwardRef(((e,o)=>{const{trapFocus:r,onOpenAutoFocus:t,onCloseAutoFocus:n,disableOutsidePointerEvents:c,onEscapeKeyDown:l,onPointerDownOutside:p,onFocusOutside:d,onInteractOutside:f,...C}=e,P=g("PopoverContent");return useFocusGuards(),/*#__PURE__*/React.createElement(FocusScope,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:t,onUnmountAutoFocus:n},/*#__PURE__*/React.createElement(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:f,onEscapeKeyDown:l,onPointerDownOutside:p,onFocusOutside:d,onDismiss:()=>P.onOpenChange(!1)},/*#__PURE__*/React.createElement(Content$1,_extends({"data-state":E(P.open),role:"dialog",id:P.contentId},C,{ref:o,style:{...C.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)"}}))))}));const PopoverClose=/*#__PURE__*/React.forwardRef(((e,o)=>{const r=g("PopoverClose");return React.createElement(Primitive.button,_extends({type:"button"},e,{ref:o,onClick:composeEventHandlers(e.onClick,(()=>r.onOpenChange(!1)))}))}));const PopoverArrow=/*#__PURE__*/React.forwardRef(((e,o)=>/*#__PURE__*/React.createElement(Arrow$1,_extends({},e,{ref:o}))));function E(e){return e?"open":"closed"}const Root=Popover;const Trigger=PopoverTrigger;const Content=PopoverContent;const Close=PopoverClose;const Arrow=PopoverArrow;

export { Arrow, Close, Content, Popover, PopoverArrow, PopoverClose, PopoverContent, PopoverTrigger, Root, Trigger };
